const numTanks=2,numTrees=200,mapWidth=1920,mapHeight=1280,tankWidth=50,tankHeight=50,baseWidth=400,baseHeight=400,treeWidth=172,treeHeight=335,treeTrunkWidth=10,treeTrunkHeight=10,treeTrunkXOffset=58,treeTrunkYOffset=176,baseSeparation=400,tanks=[],bases=[],trees=[];let timer=0,tag_timer=200;const move_res_diag=2,move_res=3,msec_rate=40;let do_check_move=!1,valid_key=!1,play_status=!1;class Sprite{constructor(t){this.id=t.id,this.className=t.className,this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h,this.colX=t.colX,this.colY=t.colY,this.colW=t.colW,this.colH=t.colH,this.speed=t.speed,this.angle=t.angle,this.tagged=t.false,this.tagable=t.tagable}update=function(t){this.x=t.x,this.y=t.y,this.speed=t.speed,this.angle=t.angle,this.w=t.w,this.h=t.h,this.tagged=t.tagged};draw=function(t){if(t){const e=document.createElement("div");e.id=this.id,e.style.left=this.x+"px",e.style.top=this.y+"px",e.className=this.className,t.appendChild(e)}}}for(let t=0;t<2;t++){let e=0,a=0,s=!0;for(;s;)e=Math.floor(1520*Math.random()),a=Math.floor(880*Math.random()),s=checkArrayCollision(bases,{colX:e,colY:a,colW:400,colH:400});const n=new Sprite({id:`base_${t}`,className:"base",x:e,y:a,w:400,h:400,colX:e,colY:a,colW:400,colH:400,speed:0,angle:0,tagged:!1,tagable:!1});n.draw(document.getElementById("canvas_0")),n.draw(document.getElementById("canvas_1")),n.draw(document.getElementById("canvas_2")),bases.push(n);const l=new Sprite({id:`tank_${t}`,className:`tank_${t} tank rotate-135`,x:e+200-25,y:a+200-25,w:50,h:50,colX:e+200-25,colY:a+200-25,colW:50,colH:50,speed:0,angle:135,tagged:!1,tagable:!0});l.draw(document.getElementById("canvas_0")),l.draw(document.getElementById("canvas_1")),tanks.push(l)}for(let t=0;t<200;t++){let e=0,a=0,s=!0;for(;s;)e=Math.floor(1910*Math.random()),a=Math.floor(1270*Math.random()),s=checkArrayCollision(bases,{colX:e-172+58,colY:a-335+176,colW:10,colH:10});const n=new Sprite({id:`tree_${t}`,className:`tree_${Math.floor(2*Math.random())+1} tree`,x:e-172,y:a-335,w:172,h:335,colX:e-172+58,colY:a-335+176,colW:10,colH:10,speed:0,angle:0,tagged:!1,tagable:!1});n.draw(document.getElementById("canvas_0")),n.draw(document.getElementById("canvas_1")),trees.push(n)}function init(){$(".canvas").css("width",1920),$(".canvas").css("height",1280),$(".tank").css("width",50),$(".tank").css("height",50),set_tagged("tank_"+Math.floor(2*Math.random())),document.onkeydown=keyListener,play_status=!1,set_scroll(tanks[0].x,tanks[0].y,tanks[0].id),set_scroll(tanks[1].x,tanks[1].y,tanks[1].id)}function set_tagged(t){$(".tank").removeClass("tagged"),tanks[0].id==t?(tanks[0].tagged=!0,tanks[1].tagged=!1,$(".tank_0").addClass("tagged")):tanks[1].id==t&&(tanks[0].tagged=!1,tanks[1].tagged=!0,$(".tank_1").addClass("tagged")),tag_timer=200}function checkArrayCollision(t,e){let a=!1;for(let s=0;s<t.length;s++)if(t[s].id!==e.id&&checkObjectCollision(t[s],e)){t[s].className.includes("tank")&&e.className.includes("tank")&&e.tagged&&t[s].tagable&&tag_timer<=0&&set_tagged(t[s].id),a=!0;break}return a}function checkObjectCollision(t,e){return t.colX<e.colX+e.colW&&t.colX+t.colW>e.colX&&t.colY<e.colY+e.colH&&t.colY+t.colH>e.colY}function move_tank(t){$("."+t.id).animate({left:t.x+"px",top:t.y+"px"},1),set_scroll(t.x,t.y,t.id)}function set_scroll(t,e,a){var s=t-$("#container_"+a).width()/2,n=e-$("#container_"+a).height()/2;s<0&&(s=0),n<0&&(n=0),$("#container_"+a).scrollLeft(s).scrollTop(n)}function check_move(t,e){var a=t.x,s=t.y;0!=t.speed&&(1==t.speed?0==t.angle?t.y-=6:45==t.angle?(t.y-=4,t.x+=4):90==t.angle?t.x+=6:135==t.angle?(t.x+=4,t.y+=4):180==t.angle?t.y+=6:225==t.angle?(t.x-=4,t.y+=4):270==t.angle?t.x-=6:315==t.angle&&(t.x-=4,t.y-=4):-1==t.speed&&(0==t.angle?t.y+=3:45==t.angle?(t.y+=2,t.x-=2):90==t.angle?t.x-=3:135==t.angle?(t.x-=2,t.y-=2):180==t.angle?t.y-=3:225==t.angle?(t.x+=2,t.y-=2):270==t.angle?t.x+=3:315==t.angle&&(t.x+=2,t.y+=2)),t.x<0?t.x=0:t.x>1870&&(t.x=1870),t.y<0?t.y=0:t.y>1230&&(t.y=1230),t.colX=t.x,t.colY=t.y,checkArrayCollision(trees,t)||checkArrayCollision(tanks,t)?(t.x=a,t.y=s):(move_tank(t),set_stats(t)))}function set_stats(t){$(`#${t.id}_x_pos`).html(`${t.x}`),$(`#${t.id}_y_pos`).html(`${t.y}`),$(`#${t.id}_angle`).html(`${t.angle}`)}function keyListener(t){const e={73:()=>{186===$("#instructions").height()?$("#instructions").animate({height:"20px"},500):$("#instructions").animate({height:"186px"},500)},32:()=>{play_status?stop_game():start_game(),$(".paused").toggle()},38:()=>{tanks[0].speed++,tanks[0].speed=Math.min(1,tanks[0].speed)},40:()=>{tanks[0].speed--,tanks[0].speed=Math.max(-1,tanks[0].speed)},39:()=>{tanks[0].angle=(tanks[0].angle+45)%360,$(".tank_0").css("transform",`rotate(${tanks[0].angle}deg)`),set_stats(tanks[0])},37:()=>{tanks[0].angle=(tanks[0].angle-45+360)%360,$(".tank_0").css("transform",`rotate(${tanks[0].angle}deg)`),set_stats(tanks[0])},87:()=>{tanks[1].speed++,tanks[1].speed=Math.min(1,tanks[1].speed)},83:()=>{tanks[1].speed--,tanks[1].speed=Math.max(-1,tanks[1].speed)},68:()=>{tanks[1].angle=(tanks[1].angle+45)%360,$(".tank_1").css("transform",`rotate(${tanks[1].angle}deg)`),set_stats(tanks[1])},65:()=>{tanks[1].angle=(tanks[1].angle-45+360)%360,$(".tank_1").css("transform",`rotate(${tanks[1].angle}deg)`),set_stats(tanks[1])}}[t.keyCode];e&&(e(),valid_key=!0)}function play_game(){check_move(tanks[0],tanks[1]),check_move(tanks[1],tanks[0]),$("#timer").html(timer),$("#tag_timer").html(tag_timer),tag_timer>0&&tag_timer--,play_status&&(timer=setTimeout("play_game()",40))}function stop_game(){play_status=!1}function start_game(){play_status=!0,play_game()}set_stats(tanks[0]),set_stats(tanks[1]);